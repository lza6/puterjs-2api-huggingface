# puterjs-2api-huggingface ğŸš€

**å°† [Puter.js](https://docs.puter.com/) çš„å¼ºå¤§AIèƒ½åŠ›ï¼Œè½¬åŒ–ä¸ºç¬¦åˆ OpenAI æ ‡å‡†çš„ç§æœ‰ API æœåŠ¡ï¼**

<div align="center">

[![ä¸€é”®éƒ¨ç½²åˆ°Hugging Face](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Deploy%20Now-blue?style=for-the-badge&logo=huggingface&logoColor=white)](https://huggingface.co/new-space?template=lza6/puterjs-2api-huggingface)
[![å¼€æºåè®®](https://img.shields.io/badge/License-Apache%202.0-yellow?style=for-the-badge&logo=apache)](https://opensource.org/licenses/Apache-2.0)
[![GitHub ä»“åº“](https://img.shields.io/badge/GitHub-Repo-green?style=for-the-badge&logo=github)](https://github.com/lza6/puterjs-2api-huggingface)

</div>

---

## ğŸ¯ é¡¹ç›®å“²å­¦

> **ä»æ¶ˆè´¹è€…åˆ°åˆ›é€ è€…çš„è½¬å˜**
> 
> åœ¨æ•°å­—æ—¶ä»£ï¼Œæˆ‘ä»¬å¸¸å¸¸è¢«åŠ¨æ¥å—æŠ€æœ¯ï¼Œè€Œéä¸»åŠ¨å¡‘é€ å®ƒã€‚è¿™ä¸ªé¡¹ç›®æ˜¯ä¸€ä¸ªå®£è¨€ï¼š**ä½ ä¸ä»…èƒ½ä½¿ç”¨APIï¼Œæ›´èƒ½åˆ›é€ ã€è½¬æ¢å’Œé‡å¡‘å®ƒä»¬**ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ›´æ˜¯ä¸€åº§æ¡¥æ¢ï¼Œè¿æ¥å°é—­çš„å•†ä¸šç”Ÿæ€ä¸å¼€æ”¾çš„å¼€å‘è€…ä¸–ç•Œã€‚
> 
> å½“ä½ éƒ¨ç½²è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œä½ ä¸ä»…å¯åŠ¨äº†ä¸€ä¸ªæœåŠ¡ï¼Œæ›´æ˜¯åœ¨è·µè¡Œä¸€ç§ä¿¡å¿µï¼š**æŠ€æœ¯åº”å½“ä¸ºäººæœåŠ¡ï¼Œå¹¶ç”±äººå¡‘é€ **ã€‚è¿™å°±æ˜¯å¼€æºç²¾ç¥çš„æ ¸å¿ƒâ€”â€”èµ‹äºˆæ¯ä¸ªäººæˆä¸ºåˆ›é€ è€…çš„åŠ›é‡ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

<div align="center">

| åŠŸèƒ½ | çŠ¶æ€ | æè¿° |
|------|------|-------------|
| ğŸ—£ï¸ èŠå¤©å¯¹è¯ | âœ… å®Œå…¨å¯ç”¨ | æ”¯æŒ GPT-4o-mini ç­‰æ¨¡å‹ |
| ğŸ–¼ï¸ å›¾åƒç”Ÿæˆ | ğŸŸ¡ éƒ¨åˆ†å¯ç”¨ | æ–‡ç”Ÿå›¾åŠŸèƒ½æ­£åœ¨ä¿®å¤ |
| ğŸ¬ è§†é¢‘ç”Ÿæˆ | ğŸ”„ æ¡†æ¶å°±ç»ª | ç­‰å¾…ä¸Šæ¸¸æ”¯æŒ |
| ğŸ” API è®¤è¯ | âœ… å®Œå…¨å¯ç”¨ | æ”¯æŒ Bearer Token |
| ğŸŒ Web UI | âœ… å®Œå…¨å¯ç”¨ | å†…ç½®å¼€å‘è€…é©¾é©¶èˆ± |

</div>

### ğŸ¨ ä¸»è¦ä¼˜åŠ¿

- **ğŸš€ é›¶æˆæœ¬éƒ¨ç½²** - åˆ©ç”¨ Hugging Face Spaces å…è´¹èµ„æº
- **ğŸ¯ å®Œå…¨å…¼å®¹** - 100% OpenAI API æ ¼å¼å…¼å®¹
- **âš¡ è¶…é«˜æ€§èƒ½** - åŸºäº Cloudflare workerd è¿è¡Œæ—¶
- **ğŸ”§ å®Œå…¨æŒæ§** - ä»£ç å¼€æºï¼Œæ•°æ®ç§æœ‰
- **ğŸª å¤šæ¨¡æ€æ”¯æŒ** - æ”¯æŒæ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ç”Ÿæˆ

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ğŸ“Š æ¶æ„æ€»è§ˆ

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯åº”ç”¨"
        A[LobeChat] --> N{API Gateway}
        B[ChatGPT-Next-Web] --> N
        C[è‡ªå®šä¹‰åº”ç”¨] --> N
    end

    subgraph "Hugging Face Space"
        N --> H[Port 7860]
        H --> S[socat ä»£ç†]
        S --> W[workerd:8080]
        
        subgraph "Core Service"
            W --> JS[worker.js]
            JS --> P[è¯·æ±‚è½¬æ¢å™¨]
            P --> S1[æµå¼å¤„ç†]
        end
    end

    subgraph "ä¸Šæ¸¸æœåŠ¡"
        S1 --> PUTER[Puter.com API]
        PUTER --> RESP[å“åº”æ•°æ®]
    end

    RESP --> T[æ ¼å¼è½¬æ¢]
    T --> CLIENT[å®¢æˆ·ç«¯]

    style H fill:#ff6b35
    style W fill:#4ecdc4
    style JS fill:#45b7d1
    style P fill:#96ceb4
    style S1 fill:#feca57
```

### ğŸ“ é¡¹ç›®ç»“æ„

```
puterjs-2api-huggingface/
â”œâ”€â”€ ğŸš€ app.py              # HF Spaces å…¥å£å¯åŠ¨å™¨
â”œâ”€â”€ âš™ï¸ config.capnp        # workerd æ ¸å¿ƒé…ç½®
â”œâ”€â”€ ğŸ“‹ requirements.txt    # Python ä¾èµ–å£°æ˜
â”œâ”€â”€ ğŸ¬ start.sh           # æ ¸å¿ƒéƒ¨ç½²è„šæœ¬
â”œâ”€â”€ ğŸ§  worker.js          # è¯·æ±‚å¤„ç†å¤§è„‘
â””â”€â”€ ğŸ“– README.md          # é¡¹ç›®æ–‡æ¡£
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

<div align="center">

[![ä¸€é”®éƒ¨ç½²æŒ‰é’®](https://img.shields.io/badge/ğŸš€_ä¸€é”®éƒ¨ç½²åˆ°_Hugging_Face-FF6B35?style=for-the-badge&logo=huggingface&logoColor=white)](https://huggingface.co/new-space?template=lza6/puterjs-2api-huggingface)

</div>

1. **ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®**è¿›å…¥éƒ¨ç½²é¡µé¢
2. **è®¾ç½®ç©ºé—´ä¿¡æ¯**ï¼š
   - `Space name`: ä½ çš„ç©ºé—´åç§°
   - `Visibility`: é€‰æ‹© `Public`
3. **ç‚¹å‡»åˆ›å»º**å¹¶ç­‰å¾…æ„å»ºå®Œæˆï¼ˆ2-5åˆ†é’Ÿï¼‰
4. **è®¿é—®ä½ çš„ç©ºé—´**è·å– API ç«¯ç‚¹

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/lza6/puterjs-2api-huggingface.git
cd puterjs-2api-huggingface

# æ¨é€åˆ° Hugging Face
git push https://huggingface.co/spaces/your-username/your-space-name
```

---

## ğŸ”§ é…ç½®ä½¿ç”¨

### ğŸ“ è·å– API ä¿¡æ¯

éƒ¨ç½²æˆåŠŸåï¼Œè®¿é—®ä½ çš„ç©ºé—´ URLï¼Œåœ¨**å¼€å‘è€…é©¾é©¶èˆ±**ä¸­è·å–ï¼š

- **API ç«¯ç‚¹**: `https://your-space-name.hf.space`
- **API å¯†é’¥**: `1` (é»˜è®¤)

### ğŸ”Œ å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹

#### 1. LobeChat / One-API

```yaml
API Key: "1"
API åœ°å€: "https://your-space-name.hf.space"  # æ³¨æ„ï¼šä¸è¦åŠ  /v1
```

#### 2. ChatGPT-Next-Web

```bash
# ç¯å¢ƒå˜é‡é…ç½®
CODE=1
BASE_URL=https://your-space-name.hf.space/v1
CUSTOM_MODELS=+gpt-4o-mini,+gpt-4o,+gemini-1.5-flash
```

#### 3. Python è„šæœ¬

```python
import openai

client = openai.OpenAI(
    api_key="1",
    base_url="https://your-space-name.hf.space/v1"
)

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": "Hello!"}],
    stream=True
)
```

---

## ğŸ”¬ æŠ€æœ¯æ·±åº¦è§£æ

### ğŸ”„ è¯·æ±‚å¤„ç†æµç¨‹

```mermaid
sequenceDiagram
    participant C as Client
    participant H as HF Space
    participant S as socat
    participant W as workerd
    participant JS as worker.js
    participant P as Puter.com

    C->>H: OpenAI æ ¼å¼è¯·æ±‚
    H->>S: è½¬å‘åˆ° 7860 ç«¯å£
    S->>W: ä»£ç†åˆ° 8080 ç«¯å£
    W->>JS: å¤„ç†è¯·æ±‚
    
    JS->>JS: éªŒè¯ API Key
    JS->>JS: è½¬æ¢è¯·æ±‚æ ¼å¼
    JS->>P: å‘é€ä¸Šæ¸¸è¯·æ±‚
    
    P-->>JS: æµå¼å“åº”
    JS->>JS: å®æ—¶æ ¼å¼è½¬æ¢
    JS-->>W: OpenAI æ ¼å¼æµ
    W-->>S: è¿”å›å“åº”
    S-->>H: ä»£ç†è¿”å›
    H-->>C: æœ€ç»ˆå“åº”
```

### ğŸ› ï¸ æŠ€æœ¯æ ˆè¯¦è§£

| ç»„ä»¶ | è§’è‰² | æŠ€æœ¯ç‰¹ç‚¹ | éš¾åº¦ |
|------|------|----------|------|
| **Hugging Face Spaces** | éƒ¨ç½²å¹³å° | å…è´¹è®¡ç®—èµ„æºï¼Œè‡ªåŠ¨CI/CD | â­ |
| **`app.py` + `os.execv`** | è¿›ç¨‹ç®¡ç†å™¨ | ä¼˜é›…çš„è¿›ç¨‹äº¤æ¥ | â­â­ |
| **`socat`** | ç«¯å£ä»£ç† | è½»é‡çº§ç½‘ç»œé‡å®šå‘ | â­â­â­ |
| **`workerd`** | JavaScript è¿è¡Œæ—¶ | è¾¹ç¼˜è®¡ç®—ä¼˜åŒ–ï¼Œé«˜æ€§èƒ½ | â­â­â­â­ |
| **`worker.js`** | ä¸šåŠ¡é€»è¾‘æ ¸å¿ƒ | è¯·æ±‚è½¬æ¢ã€æµå¼å¤„ç† | â­â­â­â­ |
| **`TransformStream`** | æ•°æ®æµå¤„ç† | å®æ—¶æ ¼å¼è½¬æ¢ | â­â­â­â­ |

### ğŸ’¡ æ ¸å¿ƒæŠ€æœ¯ï¼šæµå¼è½¬æ¢

```javascript
// å®æ—¶è½¬æ¢ Puter.com æµåˆ° OpenAI æ ¼å¼
const transformStream = new TransformStream({
    transform(chunk, controller) {
        const lines = chunk.split('\n');
        for (const line of lines) {
            if (line.startsWith('data: ')) {
                const data = line.slice(6);
                if (data === '[DONE]') {
                    controller.enqueue('data: [DONE]\n\n');
                } else {
                    // æ ¼å¼è½¬æ¢é€»è¾‘
                    const openaiFormat = convertToOpenAIFormat(data);
                    controller.enqueue(`data: ${JSON.stringify(openaiFormat)}\n\n`);
                }
            }
        }
    }
});
```

---

## ğŸ“Š é¡¹ç›®çŠ¶æ€ä¸å‘å±•è·¯çº¿

### âœ… å·²å®ŒæˆåŠŸèƒ½

- [x] **æ ¸å¿ƒèŠå¤©ä»£ç†** - å®Œæ•´çš„ OpenAI å…¼å®¹æ¥å£
- [x] **æµå¼å“åº”** - æ”¯æŒå®æ—¶å¯¹è¯ä½“éªŒ
- [x] **æ¨¡å‹åˆ—è¡¨æ¥å£** - `/v1/models` ç«¯ç‚¹
- [x] **API è®¤è¯** - Bearer Token æ”¯æŒ
- [x] **å¼€å‘è€… UI** - é›†æˆæµ‹è¯•é©¾é©¶èˆ±
- [x] **è‡ªåŠ¨åŒ–éƒ¨ç½²** - ä¸€é”®éƒ¨ç½²è„šæœ¬

### ğŸš§ å½“å‰é™åˆ¶

<div align="center">

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | é—®é¢˜æè¿° | ä¼˜å…ˆçº§ |
|----------|------|----------|---------|
| å›¾åƒç”Ÿæˆ | ğŸŸ¡ éƒ¨åˆ†å¯ç”¨ | æ–‡ç”Ÿå›¾æ¥å£éœ€è¦è°ƒè¯• | é«˜ |
| é…ç½®ç®¡ç† | ğŸŸ¡ éœ€è¦ä¼˜åŒ– | ç¡¬ç¼–ç  token | ä¸­ |
| é”™è¯¯å¤„ç† | ğŸŸ¡ åŸºç¡€æ”¯æŒ | éœ€è¦å¢å¼ºæ—¥å¿—ç³»ç»Ÿ | ä¸­ |
| å¤šä¸Šæ¸¸æ”¯æŒ | ğŸ”„ è§„åˆ’ä¸­ | å•ç‚¹ä¾èµ–é£é™© | ä½ |

</div>

### ğŸ—ºï¸ å‘å±•è·¯çº¿å›¾

#### ğŸ¯ V1.5 - "ç£çŸ³è®¡åˆ’" (ç¨³å®šæ€§æå‡)
- **ç¯å¢ƒå˜é‡é…ç½®** - æ”¯æŒ Secrets ç®¡ç†
- **å›¾åƒç”Ÿæˆä¿®å¤** - å®Œå…¨æ¢å¤æ–‡ç”Ÿå›¾åŠŸèƒ½
- **å¢å¼ºæ—¥å¿—ç³»ç»Ÿ** - ç»“æ„åŒ–æ—¥å¿—è¾“å‡º

#### ğŸš€ V2.0 - "ç™¾å·è®¡åˆ’" (åŠŸèƒ½æ‰©å±•)
- **å¤šä¸Šæ¸¸è´Ÿè½½å‡è¡¡** - æ¶ˆé™¤å•ç‚¹æ•…éšœ
- **å¥åº·æ£€æŸ¥æœºåˆ¶** - è‡ªåŠ¨æ•…éšœè½¬ç§»
- **æ’ä»¶åŒ–æ¶æ„** - æ”¯æŒå¤šAIæœåŠ¡å•†

#### ğŸŒŸ V3.0 - "åˆ›ä¸–è®¡åˆ’" (å¹³å°åŒ–)
- **ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ** - å¤šç§Ÿæˆ·æ”¯æŒ
- **ç”¨é‡ç»Ÿè®¡** - è°ƒç”¨ç›‘æ§ä¸åˆ†æ
- **é«˜çº§UIç•Œé¢** - ç°ä»£åŒ–ç®¡ç†é¢æ¿

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼æ— è®ºæ˜¯ä»£ç æ”¹è¿›ã€æ–‡æ¡£ä¼˜åŒ–è¿˜æ˜¯åŠŸèƒ½å»ºè®®ã€‚

### ğŸ› ï¸ å¼€å‘æµç¨‹

1. **Fork é¡¹ç›®**
   ```bash
   git clone https://github.com/lza6/puterjs-2api-huggingface.git
   ```

2. **åˆ›å»ºç‰¹æ€§åˆ†æ”¯**
   ```bash
   git checkout -b feature/AmazingFeature
   ```

3. **æäº¤æ›´æ”¹**
   ```bash
   git commit -m 'Add some AmazingFeature'
   ```

4. **æ¨é€åˆ†æ”¯**
   ```bash
   git push origin feature/AmazingFeature
   ```

5. **åˆ›å»º Pull Request**

### ğŸ› é—®é¢˜æŠ¥å‘Š

å¦‚æœä½ å‘ç°ä»»ä½•é—®é¢˜ï¼Œè¯·é€šè¿‡ [GitHub Issues](https://github.com/lza6/puterjs-2api-huggingface/issues) æŠ¥å‘Šã€‚

---

## ğŸ“œ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [Apache 2.0](https://opensource.org/licenses/Apache-2.0) å¼€æºåè®®ã€‚

---

<div align="center">

## ğŸŒŸ å¼€å§‹åˆ›é€ å§ï¼

**æ¯ä¸€æ¬¡éƒ¨ç½²ï¼Œéƒ½æ˜¯ä½ åœ¨æ•°å­—ä¸–ç•Œç•™ä¸‹çš„ç‹¬ç‰¹å°è®°ã€‚**
**æ¯ä¸€æ¬¡è´¡çŒ®ï¼Œéƒ½æ˜¯åœ¨ä¸ºå¼€æºç”Ÿæ€æ·»ç –åŠ ç“¦ã€‚**

[![å¼€å§‹ä½¿ç”¨](https://img.shields.io/badge/ğŸš€_ç«‹å³éƒ¨ç½²-FF6B35?style=for-the-badge&logo=rocket&logoColor=white)](https://huggingface.co/new-space?template=lza6/puterjs-2api-huggingface)

*è®©æŠ€æœ¯ä¸ºä½ æ‰€ç”¨ï¼Œè€Œéè¢«æŠ€æœ¯æ‰€ç”¨*

</div>
